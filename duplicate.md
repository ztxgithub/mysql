# Mysql复制

## Mysql复制概念

```shell
    Mysql复制功能提供了分担 读负载，通过复制功能对数据库进行水平扩展，为数据库服务器增加一个或多个备库，这些备库可以分担读负载。
    Mysql复制功能为高可用，灾难恢复，备份提供更多的选择。
    Mysql的复制是基于主库上的二进制日志，Mysql的复制是异步的，可以存在主从数据库不一致，
    
    Mysql复制所解决的问题:
        (1) 实现在不同服务器上的数据分布(Mysql复制是利用二进制日志增量进行，不需要太多的带宽，但是使用基于行的复制在进行大批量的
                                     更改时会对带宽带来一定的压力，应该分批进行)
        (2) 实现数据读取的负载均衡(需要其他组件配合完成，例如利用DNS轮询的方式把程序的读 连接到不同的备份数据库中，
                                也可以使用LVS，haproxy等方式)
        (3) 增加数据的安全性(复制并不能代替备份，复制只是将主库的数据拷贝到从库中，由于主从同步的延时小，如果主库中有大量错误数据，
                           则从库也很快被同步扩散，不能通过从库恢复到主库，而是得用备份的方式)
        (4) 实现数据库高可用和故障切换。
        (5) 实现数据库的在线升级
        

```

## Mysql二进制日志

```shell
    Mysql日志类型:
        (1) MySQL服务层日志
                例如二进制日志，慢查日志，通用日志，这些日志与存储引擎无关，是由MySQL服务器层来记录的，
        (2) MySQL存储引擎层日志：例如innodb重做日志和innodb回滚日志
        
    二进制日志(binlog)
        记录了所有对MySQL数据库的修改事件，包括增删改查事件和对表结构的修改事件,在binlog日志中记录的事件都是已经成功执行的，对于已经
        回滚的事件不会记录在binlog日志中
        
    二进制日志的格式
        (1) 基于段的格式 数据库系统变量binlog_format = STATEMENT,  其记录的是执行的SQL语句,如果数据库采用这种方式，在终端执行
                        mysqlbinlog命令时不需要指定任何参数，就可以清楚得从二进制日志中看出执行了那些二进制语句，
                        不管数据库系统变量binlog_format 是何值，在进行 DDL(表结构操作)时都是用基于段的格式记录在biglog中
        
        

```


